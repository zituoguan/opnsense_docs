====================================
安全性
====================================

.. contents:: 索引


------------------------------------------------------------
简介
------------------------------------------------------------

作为您信赖的开源安全产品，我们非常重视安全性，
并通过我们的定期发布计划尽量预防可能发生的安全事件。尽管我们谨慎且保持警觉，
有时问题仍然会发生，在这种情况下，了解应对措施是非常重要的。


------------------------------------------------------------
保持领先
------------------------------------------------------------

虽然我们总是鼓励用户定期更新，但有时由于各种原因无法这样做。

幸运的是，OPNsense 提供了一个集成的已知漏洞安全检查工具，可以在我们的固件模块中找到。
在这种情况下，您确实有机会自己验证保持使用当前版本
稍长时间的风险。

您可以通过 :menuselection:`系统 -> 固件` 在状态面板中找到它，
点击“运行审核”按钮将直接带您进入安全报告。

如果一切顺利，将显示如下报告：

.. code-block::

    ***收到安全审核请求***
    当前运行 OPNsense 22.1.8_1 (amd64/OpenSSL) 于 2022年5月31日 09:01:04 CEST
    vulnxml 文件是最新的
    在 0 个已安装包中发现 0 个问题。
    ***完成***


.. 注意::

    我们不提供有关评估旧版本上的事件是否需要您立即升级的社区支持，
    因为这通常取决于使用的功能和配置的设置。
    我们的建议始终是升级到最新的社区或商业版本。


.. 警告::

    请不要向我们报告由安全健康检查报告的问题，
    这些问题我们已经知道，并且下一个版本很可能已经有了修复。


------------------------------------------------------------
上游漏洞
------------------------------------------------------------

由于 OPNsense 是一套开源软件的集合，
当发现问题时，首先检查问题应该在哪里修复总是一个好主意。
如果您不知道或不确定，您仍然可以向我们询问，只是要知道我们没有足够的人力作为各个项目之间的中介。


------------------------------------------------------------
报告安全事件
------------------------------------------------------------

关于我们产品的安全事件可以报告给我们的安全团队，通过 **security** @ **opnsense.org** 联系。

所有报告至少应包含以下信息：

* 清晰描述手头的漏洞
* 我们产品的哪个版本似乎受到影响
* 任何已知的解决方法
* 如果可能，提供一些示例代码

我们的 GPG 信息用于发送加密邮件如下：

* GPG 密钥 ID: D3C7FBDB
* GPG 指纹: 97D5 0C7F EC38 22D0 85AE  51B1 C271 8D7A D3C7 FBDB

------------------------------------------------------------
信息处理政策
------------------------------------------------------------

作为一项总体政策，在允许安全分析和修正以及适当测试修正措施后的合理时间内，
我们确实倾向于完全披露漏洞信息。

为了与其他受影响方协调，我们也可能将我们获得的部分信息共享给他们，
或要求报告者这样做。

当提交者对协调披露过程感兴趣时，应在任何提交中指明，
以避免后续的讨论。


------------------------------------------------------------
第三方安全验证
------------------------------------------------------------

简介
............................................................

在 OPNsense 团队和社区中，我们投入了大量时间来保护我们的软件并跟上最新的威胁，
比如在每次发布时检查所使用的软件是否有 CVE 漏洞，实施我们开发方法中的最佳实践，
并提供清晰透明的发布工程。

为了进一步改进，我们决定引入第三方并围绕我们的安全验证构建一个流程，
该流程由受过训练的安全专业人士进行。


商业版
............................................................

由于我们的商业版面向专业用户，因此提供额外的安全保障是有意义的，比如对该产品进行更全面的测试。
从我们软件的生命周期来看，这也是我们所能提供的最成熟阶段：

* 开发版本

  - 每次发布时都可用，提供了对不久的将来可以期待的内容的预览。

* 社区版本

  - 当更改在开发版本中存活下来后，这些更改将被纳入社区版本，
    这些版本已经过内部测试，并且社区成员已经提供了反馈。

* 商业版

  - 功能变更以更保守的方式被纳入，从开发和社区收集了更多反馈，
    导致了一个任务关键版本的您所熟悉的 OPNsense 防火墙。

由于安全测试非常耗时，我们的目标是在每个主要版本发布时提供一个完整的资格认证周期。


框架/测试类型（LINCE）
............................................................

在寻找使用的框架时，我们找到了 LINCE 方法论。

LINCE 是一种轻量级的评估和认证 ICT 产品的方法论，由西班牙国家密码中心（`CCN <https://www.ccn.cni.es/index.php/en/menu-ccn-en>`__）创建，
基于常见标准原则，面向漏洞分析和渗透测试。

LINCE 相对于其他方法论的优势主要在于减少了努力和持续时间。
然而，它的应用方式也使得可以更多地关注每个产品的关键点，
给予具体实用的测试更多重量，这些测试比密集的文档或详尽的功能测试更能对抗真实威胁。

由于大多数框架不是意图非常定期地重复，我们与 `jtsec <https://www.jtsec.es/>`__ 一起提出了一种方法，
使得可以每年进行两次测试，以与我们的商业版发布保持一致。

在每个周期中，总是有可能出现（小）问题，这些问题应该修复，
OPNsense 团队与 jtsec 紧密合作，准备修复发现的问题，并确保这些修复包含在未来的（次要）版本中。


流程中的步骤
............................................................
为了更好地了解 OPNsense 的一个版本在验证方面的位置，我们在流程中区分了以下阶段，
我们也会在手头的版本上注明这些阶段。

1.  测试中 - 软件交付给 jtsec，正在处理中（OPNsense 与 jtsec 之间的互动）。
2.  已测试 - 软件已验证/测试，文档尚未发布。
3.  符合 LINCE - 测试完成，包括由 jtsec 提供的总结报告。
4.  认证待定 - 已提供正式认证。（截至 2023 年）
5.  LINCE 认证 - 由 CCN 认证。（截至 2023 年）

认证步骤计划从 2023 年开始每年执行一次，这个过程相当耗时，
但增加了另一个独立方参与进来。

时间线
............................................................
首个完全认证的产品是社区版本（21.7.1），它为我们提供了对过程的洞察，
并帮助我们改进了我们希望用于商业版的过程。我们从 22.4 版本开始这个周期，
包括由 jtsec 进行的全面测试，并为未来制定了计划。

结果
............................................................

下面列出了已经测试或当前正在测试的版本。

+----------+-----------------+------------------------------------------------------------------------------------------------------+
| 版本     | 状态            | 下载链接                                                                                             |
+==========+=================+======================================================================================================+
| BE 23.04 | 符合 LINCE      | :download:`BR23.04-STIC_OPNSENSE_CQ-ETR-v3.1.pdf <pdf/BE23.04-STIC_OPNSENSE_CQ-ETR-v3.1.pdf>`        |
|          |                 | 9cce20526a25de2f03b29dcb80df8277eac4eb02066e504396c07e0caffd104e                                     |
+----------+-----------------+------------------------------------------------------------------------------------------------------+
| BE 22.10 | 符合 LINCE      | :download:`BE22.10-STIC_OPNSENSE_CQ-ETR-v2.0.pdf <pdf/BE22.10-STIC_OPNSENSE_CQ-ETR-v2.0.pdf>`        |
|          |                 | 6fae801d18c3c8574ab8cca9a6f03f8b898dbe8a22136ee8fc8aa01173539fb4                                     |
+----------+-----------------+------------------------------------------------------------------------------------------------------+
| BE 22.04 | 符合 LINCE      | :download:`BE22.04-STIC_OPNSENSE_CQ-ETR-v1.0.pdf <pdf/BE22.04-STIC_OPNSENSE_CQ-ETR-v1.0.pdf>`        |
|          |                 | 5b303285f3b9f9cd6290a623d7c509e48c59da4c678884a1513e84ee7d06d5d1                                     |
+----------+-----------------+------------------------------------------------------------------------------------------------------+


外部参考资料
............................................................

* https://www.jtsec.es/product-security-testing

  -  `标准定义 <https://www.jtsec.es/files/CCN-LINCE-001_v0.1_final_EN.pdf>`__
  -  `评估方法 <https://www.jtsec.es/files/CCN-LINCE-002_v0.1_final_EN.pdf>`__

* https://www.ccn.cni.es/index.php/en/menu-ccn-en
* https://oc.ccn.cni.es/en/certified-products/certified-products
